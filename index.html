<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSS Tower Defense</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Comic+Neue:wght@400;700&display=swap"
        rel="stylesheet">
    <!-- inject:css -->
    <link rel="stylesheet" href="styles/app.css">
    <!-- endinject -->
    <script src="vendor/prefixfree.min.js"></script>
    <script src="vendor/howler.min.js"></script>
</head>

<body>
    <!-- Unified Start Screen (Loading + Start combined) -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-bg"></div>
        <div class="loading-text">LOADING</div>
        <div class="loading-tower">
            <div class="loading-tower-base"></div>
            <div class="loading-tower-body"></div>
            <div class="loading-tower-top"></div>
            <div class="loading-tower-turret"></div>
        </div>
        <div class="loading-dots">
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
        </div>
        <div class="loading-progress">
            <div class="loading-progress-fill"></div>
        </div>
        <div class="difficulty-select" id="difficultySelect">
            <span class="difficulty-label">Difficulty:</span>
            <button class="difficulty-btn selected" data-difficulty="normal">Normal</button>
            <button class="difficulty-btn" data-difficulty="hard">Hard</button>
            <button class="difficulty-btn" data-difficulty="expert">Expert</button>
        </div>
        <button class="loading-start" id="startBtn">START GAME</button>
        <div class="loading-instructions">
            <p>Click grid cells to place towers</p>
            <p>Defeat all enemies to win!</p>
        </div>
    </div>

    <!-- Game Over Screen -->
    <div class="game-over-screen hidden" id="gameOverScreen">
        <h1 class="game-over-title" id="gameOverTitle">Game Over</h1>
        <p class="final-score">Score: <span id="finalScore">0</span></p>
        <button class="restart-btn" id="restartBtn">Play Again</button>
    </div>

    <!-- Game UI -->
    <div class="game-ui" id="gameUI">
        <div class="top-bar">
            <div class="stat">
                <span class="stat-icon stat-icon-lives"></span>
                <span class="stat-value" id="lives">20</span>
            </div>
            <div class="stat">
                <span class="stat-icon stat-icon-gold"></span>
                <span class="stat-value" id="gold">100</span>
            </div>
            <div class="stat">
                <span class="stat-icon stat-icon-wave"></span>
                <span class="stat-value">Wave <span id="wave">1</span>/<span id="totalWaves">10</span></span>
            </div>
            <div class="stat">
                <span class="stat-icon stat-icon-score"></span>
                <span class="stat-value" id="score">0</span>
            </div>
            <div class="stat inventory-stat">
                <span class="stat-icon stat-icon-scrap"></span>
                <span class="stat-value" id="invScrap">0</span>
                <span class="stat-icon stat-icon-core"></span>
                <span class="stat-value" id="invCore">0</span>
                <span class="stat-icon stat-icon-crystal"></span>
                <span class="stat-value" id="invCrystal">0</span>
            </div>
        </div>

        <!-- Tower Shop -->
        <div class="shop-panel" id="shopPanel">
            <div class="shop-title">Towers</div>
            <div class="tower-options">
                <div class="tower-option" data-tower="arrow" data-cost="50">
                    <div class="tower-preview tower-arrow-preview"></div>
                    <div class="tower-info">
                        <span class="tower-name">Arrow</span>
                        <span class="tower-cost">50g</span>
                    </div>
                </div>
                <div class="tower-option" data-tower="cannon" data-cost="100">
                    <div class="tower-preview tower-cannon-preview"></div>
                    <div class="tower-info">
                        <span class="tower-name">Cannon</span>
                        <span class="tower-cost">100g</span>
                    </div>
                </div>
                <div class="tower-option" data-tower="ice" data-cost="75">
                    <div class="tower-preview tower-ice-preview"></div>
                    <div class="tower-info">
                        <span class="tower-name">Ice</span>
                        <span class="tower-cost">75g</span>
                    </div>
                </div>
                <div class="tower-option" data-tower="magic" data-cost="150">
                    <div class="tower-preview tower-magic-preview"></div>
                    <div class="tower-info">
                        <span class="tower-name">Magic</span>
                        <span class="tower-cost">150g</span>
                    </div>
                </div>
                <!-- NEW WEAPONS -->
                <div class="tower-option" data-tower="tesla" data-cost="200">
                    <div class="tower-preview tower-tesla-preview"></div>
                    <div class="tower-info">
                        <span class="tower-name">Tesla</span>
                        <span class="tower-cost">200g</span>
                    </div>
                </div>
                <div class="tower-option" data-tower="flame" data-cost="250">
                    <div class="tower-preview tower-flame-preview"></div>
                    <div class="tower-info">
                        <span class="tower-name">Flame</span>
                        <span class="tower-cost">250g</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Wave Control -->
        <div class="wave-control">
            <button class="wave-btn" id="startWaveBtn">Start Wave</button>
        </div>

        <!-- Tech Tree Button -->
        <div class="tech-control">
            <button class="tech-btn" id="techBtn">Tech Tree</button>
        </div>
    </div>

    <!-- Tech Tree Modal -->
    <div class="tech-modal hidden" id="techModal">
        <div class="tech-content">
            <h2 class="tech-title">R&D LAB</h2>
            <div class="tech-stats">
                <span>Level: <span id="playerLevel">1</span></span>
                <span>SP: <span id="skillPoints">0</span></span>
            </div>
            <div class="tech-grid" id="techGrid">
                <!-- Upgrades injected by JS -->
            </div>
            <button class="close-tech-btn" id="closeTechBtn">CLOSE</button>
        </div>
    </div>


    <!-- Announcement Overlay -->
    <div class="announcement-overlay" id="announcer">
        <div class="announcement-content">
            <h1 class="announcement-title"></h1>
            <p class="announcement-subtitle"></p>
        </div>
    </div>

    <!-- Game Scene -->
    <div class="scene" id="scene">
        <!-- Day/Night Sky Cycle -->
        <div class="sky-cycle">
            <div class="sky-body-container">
                <div class="sun"></div>
                <div class="moon-comic"></div>
            </div>
        </div>

        <!-- Weather Overlay -->
        <div class="weather-overlay" id="weatherOverlay">
            <div class="rain-container hidden"></div>
            <div class="snow-container hidden"></div>
            <div class="wind-container hidden"></div>
        </div>

        <!-- Floating Particles -->
        <div class="particles"></div>

        <div class="map" id="map">
            <!-- Grid cells will be generated by JavaScript -->

            <!-- Enemy container (inside map for 3D transform) -->
            <div class="enemies" id="enemies"></div>

            <!-- Projectile container (inside map for 3D transform) -->
            <div class="projectiles" id="projectiles"></div>

            <!-- Tower container (inside map for 3D transform) -->
            <div class="towers" id="towers"></div>

            <!-- Ground Shadow -->
            <div class="ground-shadow"></div>
        </div>
    </div>

    <!-- Templates -->
    <div class="templates" style="display: none;">
        <!-- Enemy template -->
        <div class="enemy-template">
            <div class="enemy">
                <div class="enemy-body"></div>
                <div class="enemy-face"></div>
                <div class="health-bar">
                    <div class="health-fill"></div>
                </div>
            </div>
        </div>

        <!-- Tower templates -->
        <div class="tower-arrow-template">
            <div class="tower tower-arrow">
                <div class="tower-base"></div>
                <div class="tower-body"></div>
                <div class="tower-top"></div>
                <div class="tower-turret"></div>
            </div>
        </div>

        <div class="tower-cannon-template">
            <div class="tower tower-cannon">
                <div class="tower-base"></div>
                <div class="tower-body"></div>
                <div class="tower-barrel"></div>
            </div>
        </div>

        <div class="tower-ice-template">
            <div class="tower tower-ice">
                <div class="tower-base"></div>
                <div class="tower-crystal"></div>
                <div class="tower-glow"></div>
            </div>
        </div>

        <div class="tower-magic-template">
            <div class="tower tower-magic">
                <div class="tower-base"></div>
                <div class="tower-orb"></div>
                <div class="tower-ring"></div>
            </div>
        </div>

        <!-- NEW TEMPLATES -->
        <div class="tower-tesla-template">
            <div class="tower tower-tesla">
                <div class="tower-base"></div>
                <div class="tower-coil"></div>
                <div class="tower-spark"></div>
            </div>
        </div>

        <div class="tower-flame-template">
            <div class="tower tower-flame">
                <div class="tower-base"></div>
                <div class="tower-tank"></div>
                <div class="tower-nozzle"></div>
            </div>
        </div>

        <!-- Projectile template -->
        <div class="projectile-template">
            <div class="projectile"></div>
        </div>
    </div>

    <!-- inject:js -->
    <script src="scripts/utils.js"></script>
    <script src="scripts/pool.js"></script>
    <script src="scripts/noise.js"></script>
    <script src="scripts/effects.js"></script>
    <script src="scripts/path.js"></script>
    <script src="scripts/weather.js"></script>
    <script src="scripts/seasons.js"></script>
    <script src="scripts/progression.js"></script>
    <script src="scripts/inventory.js"></script>
    <script src="scripts/enemy.js"></script>
    <script src="scripts/tower.js"></script>
    <script src="scripts/projectile.js"></script>
    <script src="scripts/wave.js"></script>
    <script src="scripts/display.js"></script>
    <script src="scripts/shop.js"></script>
    <script src="scripts/sfx.js"></script>
    <script src="scripts/game.js"></script>
    <script src="scripts/achievements.js"></script>
    <script src="scripts/controller.js"></script>
    <!-- endinject -->
</body>

</html>